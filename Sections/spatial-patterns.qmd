---
bibliography: 
    - ../CLER.bib
    - ../2024-cler.bib
format: pdf
---

<!-- Person responsible: Nowosad, Bosch, Hesselbarth -->
<!-- jn: should we reference software packages here (or in Software) when they implement the methods we discuss? -->

# Spatial patterns

<!-- [Methods for landscape characterization](https://doi.org/10.1016/j.landusepol.2018.04.022)
[Where are we now, and where are we going?](https://doi.org/10.1007/s10980-019-00889-6)
[Pattern metrics](https://doi.org/10.1007/s10980-018-0755-4) -->

Spatial patterns are a fundamental concept not only in landscape ecology, but also in many other fields, such as geography, biology, urban planning, and even medical studies. 
@daleSpatialPatternAnalysis2000 defined them as the scale-dependent predictability of the physical arrangement of observations, while a more general definition by @grimmPatternOrientedModellingPopulation1996 describes them as a characteristic, clearly identifiable structure in nature itself or in the data extracted from nature, indicating an underlying process that generates this pattern.
Both definitions highlight several important aspects of spatial patterns: they are related to processes, depending on the scale of observation, and can be found in data.  

The relation of spatial patterns to spatial processes is a golden grail of landscape ecology.
Patterns observed in nature contain information about the memory of the system, including its demographic processes, dispersal characteristics, and constraining factors[@wiegandUsingPatternOriented2003].
Moreover, spatial patterns are not only a result of processes but could also be a driver of them.
Thus, untangling the complex history of a landscape from its spatial patterns is a hard challenge.

Here, our focus is on the computational approaches to spatial patterns.
Thus, we will discuss the spatial patterns that could be found in data, the metrics that could be used to quantify them, and the operations that could be performed on them.

Computational approaches to spatial patterns open many new possibilities as compared to traditional methods. 
They allow not only to quantify the patterns but also to model them, simulate them, and predict them.
Moreover, they allow us to analyze large datasets and apply complex algorithms.
At the same time, the computational approaches have considerations and limitations that should be taken into account.

Every data type is a simplified model of the real world, and the spatial patterns found in the data are a simplified representation of the real spatial patterns.
Thus, the choice of the data type, the scale of the data, and the scale of the analysis are crucial for the results of the analysis.

<!-- datatype -->
Traditionally and still the most prominent, computational approaches to spatial patterns in landscape ecology revolve around "patch mosaic" model, where the landscape is represented as a raster data with different categories of land cover [@costanzaDescribingAnalyzingLandscape2019].
Another approach is the "surface model," where the landscape is represented as continuous raster data with different values of some variable, such as elevation or temperature <!--@costanzaDescribingAnalyzingLandscape2019 for more refs-->.
Importantly, both these models are based on raster data.

However, the raster data is not the only data type that could be used to represent spatial patterns.
Another important data type is vector data, which is used to represent point, line, and polygon features.
Here, the spatial patterns could be related to densities of points, ..., or shapes of polygons.
Moreover, the vector data could be used to represent the point clouds, which are the data type that is becoming more and more popular with the development of remote sensing technologies (i.e., LiDAR).
Spatial patterns in point clouds could be related to the shapes of the point clouds or the distances between points.<!--ref-->

<!-- data sources??+SAR -->
Currently, the most common data sources in landscape ecology are remote sensing data, either in a direct form (satellite images) or in an indirect form (spectral indices, land cover maps).
The number of available spatial data products is still increasing, with new sensors, new satellites, and new data processing techniques.
This trend is seen, for example, with the frequent release of new global land cover maps, such as the ESA WorldCover, Dynamic World, or the Esri LULC.
<!-- refs -->
Other examples are the increasing availability of high-resolution data and the growing popularity of LiDAR and SAR data.

<!-- scale of data -->
In computational approaches, the issue of scale is closely related to the used data. 
Here, an important distinction should be made between the scale of the data and the data resolution.
The data scale refers to the degree of generalization of the data, while the data resolution refers to the smallest unit of the data.
Thus, it is possible to have data with a high resolution but a small scale, or data with a low resolution but a large scale.

<!-- data cats -->
Similary, it is crucial to understand the thematic resolution of the data, which in landscape ecology often refers to the number and definition of the categories in the data.
<!-- ... -->

<!-- scale of analysis -->
Related to the scale of the data is the scale of the analysis.
It specifies the extent of the study area and the way the data is analyzed.
Given that the categorical rasters consist of patches, the analysis could be performed at the patch, class, or landscape level. 
However, it is possible to analyze these levels for a fixed area, using moving windows or buffers around the sampling points.

<!-- time -->
Early approaches to spatial patterns in landscape ecology were mostly static, focusing on the spatial patterns at a single point in time.
However, the development of remote sensing technologies and the availability of time series data have allowed for the analysis of spatial patterns over time.
This opportunity further highlights the importance of understanding of the used data: is it a snapshot of a single moment, a composite of multiple moments, or a temporal generalization?
The properties of the used data should be in line with the research question and the scale of the analysis.

<!-- data quality -->
It should be noted that the quality of the data is not constant and the data products are not perfect: they could contain errors and biases.
For example, the global land cover products usually have an overall accuracy of 70-80%, which means that 20-30% of the pixels are misclassified.
Moreover, the misclassification is not random, but it is often related to the land cover type, the region, and the time of the year.
<!-- refs -->
However, most landscape ecology studies treat the data as a given, without considering its accuracy or uncertainty.

<!-- data projection -->
Less discussed but often crucial is the spatial reference system of the data.
Most methods in landscape ecology assume that the data is in a Cartesian coordinate reference system, where the distance between two points is the Euclidean distance.
This assumption has an impact on measures related to distances and areas.
However, the data could be in a geographic coordinate reference system, where the distance between two points is the great-circle distance, which would render the results of the analysis incorrect.
On the other hand, many projected coordinate reference systems exist, each with its own properties -- some distort areas, some distances, some angles, and some distort all of them.

<!-- !what with fractals?
!ai and deep learning still seems to be underused in landscape ecology -->

## Landscape metrics
<!-- Hesselbarth -->

- Traditional approach to describe patterns
- Quantify categorical raster data (patch mosaic model)
- Quantify composition and configuration
- Widely applied since FRAGSTATS release
- Several alternative tools available and still widely used

## Surface metrics
<!-- Bosch, Hesselbarth -->
[Surface metrics](https://doi.org/10.1007/s10980-018-0685-1)

- More recent development
- Quantify continuous raster data (gradient surface models)
- More realistic representation of landscapes (?)
- Based on molecular physics/medicine
- Not widely adopted yet (due to missing tools?)

## Entropy
<!-- Nowosad, Bosch -->
<!-- jn: should we use equations here? -->

<!-- information (Shannon)/Shannon diversity -->
One of the most commonly used metrics in landscape ecology is the Shannon index of diversity (SHDI, @Shannon1948).
It quantifies the richness and evenness of the categories in the landscape, with higher values indicating higher diversity (more different classes and more even distribution of them).
SHDI comes from the information theory.
It is an adaptation of the Shannon entropy, which measures of the uncertainty in a random variable.

The SHDI metric is based on the composition of the landscape only, omitting the spatial configuration of the categories.
<!--composition is the most important -- Ritters-->
Thus, other measures from the information theory were adapted to landscape ecology to quantify the spatial configuration and the total complexity of the landscape.
@nowosadInformationTheoryConsistent2019a proposed to treat a categorical raster as a bivariate random variable $(x,y)$ where $x$ is the category of the focal cell and $y$ is the category of the neighboring cell.
This approach allows to compress the information about the composition and the configuration of the landscape into a co-occurrence matrix, which could be used to calculate various entropy measures.
It includes the conditional entropy (representing configurational complexity), the joint entropy (representing overall spatio-thematic complexity), the mutual information , and the relative mutual information (representing the degree of spatial autocorrelation).
<!-- https://r-spatialecology.github.io/landscapemetrics/ -->

<!-- thermodynamic (Boltzmann) -->
The last few years have seen a surge in the development of entropy-based metrics for landscape ecology based on the notions from thermodynamics initatied by the work of @vrankenReviewUseEntropy2015a and @cushmanThermodynamicsLandscapeEcology2015a.
The overreaching goal of such studies is to link landscape ecology concepts to the thermodynamic principles, such as the second law of thermodynamics.
They often use the Boltzmann entropy, which is a measure of the disorder in a system, to quantify the complexity of the landscape.
In late 1800s, Boltzmann formulated a probabilistic interpretation of the second law of thermodynamics, using the concepts of macrostate (general state of a system) and microstate (configuration of the system elements).

@Cushman2016 proposed to relate the edge lenght to the microstate of the landscape, and use the proportion of microstates to compute the relative Boltzmann entropy of a landscape mosaic in raster data.
Simoultaneously, @Gao2017 proposed to use the Boltzmann entropy to quantify the complexity of a landscape surface in raster data by transforming the input grid into a series of landscape sufraces with different levels of detail and calculating the Boltzmann entropy based on the total number of microstates that are able to generate the observed macrostate.
@zhaoCalculatingSpatialConfigurational2019 extended the original definition of Boltzmann entropy to incorporate the information about the adjancency of the same categories in the landscape mosaic.
It is also worth noting that later, Cushman refined and generalized this approach for calculations based on raster's surface model (based on mean slope) and point patterns (based on the average distance between points) [@cushmanGeneralizingBoltzmannConfigurational2021].
<!-- https://jakubnowosad.com/bespatial/ -->


claims of relations between entropy and thermodynamics
@stepinskiCurbYourEnthusiasm2022
entropy measures are still related to the underlining data representation (!)
@zhaoCalculatingSpatialConfigurational2019

<!-- "nstead of Shannon entropy, what should be used is argued to be Boltzmann (1872) entropy, and calls have recently been made to revisit it" @gaoComputationBoltzmannEntropy2019 -->

how they are related to each other
how they are related to spatial patterns and landscape ecology

- Kolmogorov, etc.; Juhász-Nagy’s information theory-based functions, Simpson index, Rao index, Pielou, Renyu, ...
@konradAdaptingMultiscaleApproach2023; 
@simpsonMeasurementDiversity1949

<!-- "Fractal dimension seems directly related to entropy." @cushmanThermodynamicsLandscapeEcology2015a -->

<!-- https://cran.r-project.org/web/packages/LandComp/index.html -->

<!-- unification for various data types, e.g., Cushman, vectormetrics -->

## Landscape mosaic
<!-- Bosch -->

## Vector metrics
<!-- Nowosad, Hesselbarth -->
<!-- jn: ask T. Matuszek for review of this section later -->

As already mentioned, the initial computational approaches in landscape ecology were based on raster data.
However, the decision on the used data model was not theorethical, but rather practical as at the time the most comonnly used software was raster-based, such as GRASS GIS.
In fact, early studies were based on polygonal vector data that was later converted to raster data for the analysis [@costanzaDescribingAnalyzingLandscape2019]<!--jn: we could also cite actual examples from that paper, but the list of the references would be long-->
<!-- jn: maybe we could also mention that it is still the case -->

The spatial vector data model is based on the representation of the Earth's surface as a set of points, lines, and polygons, where each feature is defined by its geometry and attributes.
Here, we will focus on the polygonal vector data, which is the most common in landscape ecology.
The polygons are discrete areas, with well-defined boundaries.
Thus, converting the polygons to raster data (*rasterization*) is a lossy process, where the information about the intricates of the polygon shapes is lost.
Moreover, the rasterization process largely depends on the decided resolution of the raster outcome.

Most landscape ecology studies are still based on raster data, due to the familarity with the techiniques, the availability of the data, and the availability of the software.
For example, most land cover maps (as LULC products are often related to undelining remote sensing products), and all on the global scale, are provided as rasters. 
At the same time, nowadays, vector data of land cover on regional or local scales is also available and most geospatial software support also vector data.

As hundreds of metrics have been already developed for raster data, the most straightforward approach is to reimplement the same metrics for vector data.
@yaoVecLIFrameworkCalculating2022 showed that this is possible for most of the metrics, with only several exceptions of metrics (of the shape and aggregation group), which parameters are related to the raster-format structure.
Their results highlighted that about 80% of the raster and vector-based metrics are highly correlated (for their study area), and the higher the raster resolution, the stronger the correlation is. 

While landscape ecology studies have focussed on using raster data, the vector data model has been widely used in other fields.
@maceachrenCompactnessGeographicShape1985 presented four categories of compactness measures for vector data: perimeter-area, single parameters of related circles, dispersion of elements of the area around a centroid, and direct comparison to standard shapes, 
@angelTenCompactnessProperties2010 introduced a unified theoretical foundation for measuring shape compactness.
They observed that the circle is the most compact of shapes, proposed a set of ten distinct properties of the circle, and then defined metrics associated with each of these properties.
Vector-based metrics are now popular in urban planning, as they allow to quantify the shapes of urban areas, e.g., @basaranerPerformanceShapeIndices2017a used 18 existing metrics and two new ones to characterize the complexity of building footprints.

<!-- https://github.com/r-spatialecology/vectormetrics -->

<!-- vectormetrics limitations?? 
surely, large data performance is one of them
(e.g., could we do landscapemetrics vs vectormetrics benchmarking?) -->

<!-- polygon vs multipolygon technical distinction -->

## Operations on spatial patterns

@nowosadMotifOpensourceTool2021

<!-- FOSS4G Europe pap? -->
